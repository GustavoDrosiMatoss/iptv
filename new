-- Carrega a Fluent GUI
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

local janela = Fluent:CreateWindow({
    Title = "Allan Hub - Arise",
    SubTitle = "Dungeon Automática",
    TabWidth = 160,
    Size = UDim2.fromOffset(520, 350),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

local guia = janela:AddTab({ Title = "Dungeon", Icon = "sword" })

-- Função: Ir para o Castelo
local function irParaCastelo()
    local args = {
        [1] = {
            [1] = {
                ["Event"] = "Teleport",
                ["Place"] = "Castle"
            }
        }
    }
    game:GetService("ReplicatedStorage").BridgeNet2.dataRemoteEvent:FireServer(unpack(args))
    print("✔ Indo para o Castelo...")
end

-- Função: Criar Dungeon
local function criarDungeon()
    local args = {
        [1] = {
            [1] = {
                ["Event"] = "DungeonAction",
                ["Action"] = "Create"
            },
            [2] = "\12"
        }
    }
    game:GetService("ReplicatedStorage").BridgeNet2.dataRemoteEvent:FireServer(unpack(args))
    print("✔ Dungeon criada.")
end

-- Função: Comprar Ticket
local function comprarTicket()
    local args = {
        [1] = {
            [1] = {
                ["Type"] = "Gems",
                ["Event"] = "DungeonAction",
                ["Action"] = "BuyTicket"
            },
            [2] = "\12"
        }
    }
    game:GetService("ReplicatedStorage").BridgeNet2.dataRemoteEvent:FireServer(unpack(args))
    print("✔ Ticket comprado.")
end

-- Função: Verificar se ainda existem mobs vivos
local function mobsVivos()
    local mobsFolder = workspace:FindFirstChild("__Enemies")
    if mobsFolder then
        for _, mob in pairs(mobsFolder:GetChildren()) do
            if mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                return true
            end
        end
    end
    return false
end

-- Função principal de automação
local function iniciarDungeonAutomatica()
    irParaCastelo()
    task.wait(3)
    criarDungeon()

    -- Espera até não existir mais mobs vivos
    print("⏳ Aguardando todos os mobs serem eliminados...")
    repeat
        task.wait(2)
    until not mobsVivos()

    print("✔ Todos os mobs mortos. Reiniciando Dungeon...")
    comprarTicket()
    criarDungeon()
end

-- Botão no Fluent
guia:AddButton({
    Title = "Iniciar Dungeon Automática",
    Description = "Vai para o castelo, cria dungeon e repete só quando não tiver mobs.",
    Callback = iniciarDungeonAutomatica
})